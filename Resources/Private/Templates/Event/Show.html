<div class="event-outer-wrapper">
	<div class="well">
		<div class="well well-white">
			<p class="pull-right btn {event.lights}">{event.lightsText}</p>
			<small>{event.category.name}</small>
			<h2>{event.title}</h2>
		</div>
		<table>
			<tr>
				<td class="span2">
					<small><i class="icon-tag"></i> {event.category.shortcut}-{event.accreditationNumber}</small>
				</td>
				<td class="span4">
					<small><i class="icon-calendar"></i> von {event.dateStart -> f:format.date(format: 'd.m.Y')} bis {event.dateStart -> f:format.date(format: 'd.m.Y')}</small>
				</td>
				<td class="span4">
					<small><i class="icon-home"></i> {event.accommodation.name}</small>
				</td>
			</tr>
		</table>
		<table class="table table-no-bottom">
			<tr>
				<td colspan="2">
					{event.announcement}
				</td>
			</tr>
		</table>
		<div class="tabs">
			<ul class="nav nav-tabs" id="eventDescriptionTabs">
				<li class="active"><a href="#overview" data-toggle="pill">Übersicht</a></li>
				<li><a href="#description" data-toggle="tab">Beschreibung</a></li>
				<li><a href="#content" data-toggle="tab">Inhalte</a></li>
				<li><a href="#prerequisites" data-toggle="tab">Voraussetzungen</a></li>
				<f:if condition="{event.currentUserIsRegisteredForThisEvent}">
					<li><a href="#attendees" data-toggle="tab">Teilnehmerliste</a></li>
					<li><a href="#registrationStatus" data-toggle="tab">Anmeldestatus</a></li>
				</f:if>
			</ul>

			<div class="tab-content">
				<div class="tab-pane active" id="overview">
					<table class="table table-no-border-top">
						<tr>
							<td class="span2"><strong>Dauer:</strong></td>
							<td class="span3">{event.duration} Tage</td>
							<td class="span2"><strong>Betreuungsverhältnis:</strong></td>
							<td class="span3">{event.attTeamerRatio} (Teamer:Teilnehmer)</td>
						</tr>
						<tr>
							<td class="span2"><strong>Anreise:</strong></td>
							<td class="span3">{event.travelling}</td>
							<td class="span2"><strong>Preis:</strong></td>
							<td class="span3">{event.price}</td>
						</tr>
						<tr>
							<td class="span2"><strong>Gruppengröße:</strong></td>
							<td class="span3">{event.minRegistrations} bis {event.maxRegistrations} Teilnehmer</td>
							<td class="span2"><strong>Anmeldeschluss:</strong></td>
							<td class="span3">{event.registrationDeadline  -> f:format.date(format: 'd.m.Y')}</td>
						</tr>
					</table>
				</div>
				<div class="tab-pane" id="description">
				  {event.description}
				</div>
				<div class="tab-pane" id="content">
				  {event.contents}
				</div>
				<div class="tab-pane" id="prerequisites">
				  {event.requirements}
				</div>
				<f:if condition="{event.currentUserIsRegisteredForThisEvent}">
					<div class="tab-pane" id="attendees">
						Teilnemerliste
					</div>
					<div class="tab-pane" id="registrationStatus">
						<f:if condition="{event.registrationForCurrentUser.isConfirmed}">
							<f:then>
								<div class="alert alert-success">
									<p><strong>Deine Anmeldung ist abgeschlossen und bestätigt!</strong></p>
									<f:for each="{event.registrationForCurrentUser.AllPrerequisiteFulfillments}" as="fulfillment">
										<f:if condition="{fulfillment.fulfilled}">
											<f:then><p><i class="icon-ok"></i> Erfüllt: {fulfillment.prerequisite.title}</p></f:then>
											<f:else><p><i class="icon-error"></i> Noch zu erledigen: {fulfillment.prerequisite.title}</p></f:else>
										</f:if>
									</f:for>
								</div>
							</f:then>
							<f:else>
								<div class="alert alert-error">
									<p><strong>Deine Anmeldung ist noch nicht abgeschlossen!</strong></p>
									<f:for each="{event.registrationForCurrentUser.AllPrerequisiteFulfillments}" as="fulfillment">
										<f:if condition="{fulfillment.fulfilled}">
											<f:then><p><i class="icon-ok"></i> Erfüllt: {fulfillment.prerequisite.title}</p></f:then>
											<f:else><p><i class="icon-error"></i> Noch zu erledigen: {fulfillment.prerequisite.title}</p></f:else>
										</f:if>
									</f:for>
								</div>
							</f:else>
						</f:if>
					</div>
				</f:if>
			</div>
		</div>
		<f:if condition="{event.currentUserIsNotRegisteredForThisEvent}">
			<f:then>
				<f:link.action class="btn btn-large" controller="Registration" action="register" arguments="{event: row.event.value}">Anmelden</f:link.action>
			</f:then>
			<f:else>
				<f:if condition="{row.event.value.cancelRegistrationIsPossible}">
					<f:then><f:link.action class="btn btn-large btn-danger" controller="Registration" action="unregister" arguments="{event: row.event.value}">Abmelden</f:link.action></f:then>
				</f:if>
				<f:else>
					<p class="pull-right"><i class="icon-info-sign"></i> <strong>Die Abmeldefrist ist verstrichen, du kannst dich nicht mehr abmelden!</strong></p>
				</f:else>
			</f:else>
		</f:if><br><br>
	</div>
	<f:link.action class="pull-right" controller="Event" action="list">Zurück zur Schulungsübersicht</f:link.action>
</div>

<script language="javascript">
	$('#eventDescriptionTabs').tab('show')
</script>